\section{Preliminaries}
\label{section:preliminaries}

\subsection{Approximate pattern matching}
The approximate pattern matching problem ($AMatch$) defined as follows.
Given text $t$, pattern $p$ and some threshold $h$ the \emph{approximate pattern matching} problem ask for all substrings from text $t$ that have similarity score  with given pattern $p$ at least $h$ according to some similarity function $g$.  

There exist different kinds of extensions and particular cases of this problem.
For example, \emph{complete approximate pattern matching} (\emph{CompleteMatch}) that ask for
substrings of text $t$ that are exact clones of pattern $p$.
The approach for this special case of \emph{AMatch} is usage of well-know  algorithms such as  Aho-Korasic, BouerMurr, Knuth-Morris-Pratt, and so on.
The latter one have optimal running time complexity of $O(|p|+|t|)$ for \emph{CompleteMatch} problem\cite{}.
\emph{Approximate pattern matching with k mismatches} is an another example of special case \cite{}.
The search of \emph{pattern with wildcard symbols} or search set of patterns in text $t$\cite{}, multidimensional \emph{AMatch}\cite{} , search with lenght constraint of detected duplicates \cite{} are examples of such extension.
There exits many more examples of constrainsts, extensions and special cases of \emph{AMatch} problem\cite{}.

The one of the common approach to solve approximate pattern matching is the usage of solution of  string  similarity problem.
Latter represent a set of fundamental problems such as \emph{edit distance}, \emph{longest common subsequence}, \emph{sequence alignment}.
In this paper we primarily focuses on the usage of latter two when developing algorithms.

Recently there have been developed algorithm for solving interesting  extension of \emph{AMatch} problem with length constarint\cite{•}.
Although their algorithm have poor result in terms of running time complexity, the proposed solution possesses  a completnessess proprety i.e it founds \emph{all} non-intersected clones of pattern $p$ with specified similarity threshold  and length constraint on matching substrings.
Thus, this algorithm is an subject of interest in this paper.
The complete description of algorithm and its improved version may be found in section \ref{•} respectively.


\subsection{Semi-local lcs}
First of all we give definition of \emph{lcs} and \emph{sa}.

\begin{definition}
Given two strings $a$ and $b$  the longest common subsequence (\emph{LCS}) problem ask for the maximal length of the longest common subsequence of $a$ and $b$ (\emph{lcs(a,b)}).
\end{definition} 
In other words, \emph{LCS} problem asks about maximal lcs score of two given string a and b ($lcs(a,b)$).

\begin{definition}
Given two strings $a$ and $b$ and scoring scheme $w=(w_{+},w_{0},w_{-})$  the sequence alignment (\emph{SA}) problem ask for the maximal alignment score between $a$ and $b$ ($sa(a,b)$).
\end{definition}

Scoring scheme determines how calulate alignment score of two aligned sequences.
If pair of character in aligned sequences are matches (equals) then this pair  contributes to final alignemnt score $w_{+}$, if their mismatch it contributes $w_{0}$.
If symbol $\alpha$ of one of the sequences is not aligned with  any other symbol from other sequence it means that $\alpha$ is aligned with $gap$.
Thus, this pair contributes $w_{0}$.    
The scoring scheme calculates as follows:
\begin{equation}\label{formula:sa}
\begin{aligned}
    sa(a,b,w) = w_{+}k^{+} + w_{0}k^{0} + w_{-} (|a| + |b| - 2k^{+} - 2k^{0}) =\\
    k^{+} (w_{+} - 2w_{-} ) + k^{0}  (w_{0} - 2w_{-}) + w_{-}(|a| + |b|)
\end{aligned}
\end{equation}
The $k^{+}$ states for the number of matching symbols, $k^{-}$ --- mismatched symbols. 

Note that  \emph{LCS} is a special case of \emph{SA} when scoring scheme is $(1,0,0)$.

Both described problems are solved by  classical dynamic programming algorithm and have running time complexity $O(|a||b|)$.
$LCS$ and $SA$ allow you to find how much whole given strings are similar i/e how similar two string in a global sense.

In many cases, this is not enogh.
There also exist fully local version of these problems and semi-local one.
The last one is in sight of this paper due to natural applicability to approximate pattern matching. 
\subsection{Semi-local lcs}

Given two strings $a$ and $b$ the semi-local lcs is asks about
lcs scores for following:
\begin{enumerate}
\item \emph{string-substring}: whole $a$ against every substring of $b$
\item \emph{substring-string}: whole $b$ against every substring of $a$
\item \emph{prefix-suffix}: every prefix of $a$ against every suffix of $b$
\item \emph{suffix-prefix}: every prefix of $b$ against every suffix of $a$
\end{enumerate} 


The following \emph{semi-local lcs matrix} associated with the defined \emph{semi-local lcs}.
\begin{definition}
The \emph{semi-local lcs matrix}  $H_{a,b}$ for strings a,b defined as follows:
\begin{equation}
	H_{a,b}[i,j] = if (j\leq i) j-i  else lcs(a,b^{pad}[i,j]) 
\end{equation} 
where $i \in [-|a|:|b|], j \in [0:|a|+|b|] $.

The semi-local lcs matrix $H_{a,b}$ comprises from four
quadrant associated with described  subproblems:
\begin{equation}
 H_{a,b} = \begin{bmatrix}
H_{a,b}^{suf-pre} & H_{a,b}^{sub-str} \\
H_{a,b}^{str-sub} & H_{a,b}^{pre-suf} 
\end{bmatrix}    
\end{equation}

In \cite{tiskin} is proved that ${H_a,b}$ is unit anti Monge.

def monge matrix,anti monge,dominance sum,canonical decomposition, incremental queries.


We particulary interesting in lower left quadrant that refers to string substring problem:
\begin{equation}
H_{a,b}^{str-sub}[i,j] = lcs(a,b[i,j]),i,j \in [0,|b|] 
\end{equation}

\subsection{Semi-local sa}
The semi-local sequence alignment (sa) is a generalazation of semi-loca lcs in same sense as seqeucne alignemnt is generelaztion of lcs.

Given two strings $a$ and $b$ and scoring scheme $w=(w_{+},w_{0},w_{-})$  the semi-local sa is asks about
sa scores for following:
\begin{enumerate}
\item \emph{string-substring}: whole $a$ against every substring of $b$
\item \emph{substring-string}: whole $b$ against every substring of $a$
\item \emph{prefix-suffix}: every prefix of $a$ against every suffix of $b$
\item \emph{suffix-prefix}: every prefix of $b$ against every suffix of $a$
\end{enumerate} 

The associated matrix for semi-local sa defined analogously as for semi-local lcs.

blown-up tecnhique.

theorems of running time complexity.

 





\end{definition}

\subsection{Monge matrix}
Describe monge property  


Say about range queries (about soda12, soda14 and new result that we will be used)

\subsection{Near-duplicate detection algorithm}

Describe luciv algo

